<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Test ROME Integration</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #00ff00;
            padding: 20px;
        }

        .test-section {
            background: #2a2a2a;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #00ff00;
        }

        .success {
            color: #00ff00;
        }

        .error {
            color: #ff0000;
        }

        .info {
            color: #00aaff;
        }

        pre {
            background: #000;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <h1>üß™ NextStep - Test d'Int√©gration ROME</h1>
    <div id="results"></div>

    <script src="rome_database.js"></script>
    <script>
        const results = document.getElementById('results');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-section ${type}`;
            div.innerHTML = message;
            results.appendChild(div);
        }

        // Test 1: Base de donn√©es ROME charg√©e
        log('<h2>Test 1: Chargement de la base ROME</h2>', 'info');
        if (window.ROME_DATABASE) {
            const count = Object.keys(window.ROME_DATABASE).length;
            log(`‚úÖ Base ROME charg√©e avec <strong>${count} codes m√©tiers</strong>`, 'success');
            log(`<pre>${JSON.stringify(Object.keys(window.ROME_DATABASE), null, 2)}</pre>`);
        } else {
            log('‚ùå Base ROME non charg√©e', 'error');
        }

        // Test 2: Fonction de d√©tection ROME
        log('<h2>Test 2: D√©tection automatique du code ROME</h2>', 'info');
        const testJobs = [
            { title: "D√©veloppeur Full Stack", skills: ["React", "Node.js", "MongoDB"] },
            { title: "Chef de projet IT", skills: ["Gestion de projet", "Agile", "SCRUM"] },
            { title: "Administrateur syst√®me", skills: ["Linux", "Docker", "Kubernetes"] },
            { title: "Designer UX/UI", skills: ["Figma", "Adobe XD", "Prototypage"] }
        ];

        testJobs.forEach(job => {
            const rome = window.findBestROMECode(job.title, job.skills);
            log(`
                <strong>Poste:</strong> ${job.title}<br>
                <strong>Code ROME d√©tect√©:</strong> ${rome.code} - ${rome.libelle}<br>
                <strong>Comp√©tences ROME:</strong> ${rome.competences.slice(0, 3).join(', ')}
            `, 'success');
        });

        // Test 3: Enrichissement d'une offre
        log('<h2>Test 3: Enrichissement d\'une offre</h2>', 'info');
        const mockOffer = {
            company: "Airbus",
            role: "D√©veloppeur Fullstack IA",
            req: "React.js, Node.js, Python, Machine Learning",
            distance: "8.4 km",
            contract: "Alternance",
            city: "Marignane",
            score: 88
        };

        const enrichedOffer = window.enrichOfferWithROME(mockOffer);
        log(`<pre>${JSON.stringify(enrichedOffer, null, 2)}</pre>`, 'success');

        // Test 4: Compatibilit√© ROME
        log('<h2>Test 4: V√©rification de compatibilit√© ROME</h2>', 'info');
        const studentProfile = {
            name: "Sophie",
            skills: ["React", "Node.js", "Python", "Git"],
            formation: "BUT Informatique"
        };

        const compatibility = window.checkROMECompatibility(studentProfile, mockOffer);
        log(`
            <strong>Profil √©tudiant:</strong> ${studentProfile.name} (${studentProfile.formation})<br>
            <strong>Comp√©tences:</strong> ${studentProfile.skills.join(', ')}<br>
            <strong>Score de compatibilit√©:</strong> ${compatibility.score}%<br>
            <strong>Comp√©tences acquises:</strong> ${compatibility.matchingSkills.join(', ')}<br>
            <strong>Comp√©tences √† d√©velopper:</strong> ${compatibility.missingSkills.join(', ')}<br>
            <strong>Explication:</strong> ${compatibility.explanation}
        `, compatibility.score >= 60 ? 'success' : 'error');

        // Test 5: R√©sum√© final
        log('<h2>‚úÖ R√©sum√© des Tests</h2>', 'success');
        log(`
            <ul>
                <li>‚úÖ Base de donn√©es ROME: <strong>OK</strong></li>
                <li>‚úÖ D√©tection automatique: <strong>OK</strong></li>
                <li>‚úÖ Enrichissement offres: <strong>OK</strong></li>
                <li>‚úÖ Matching p√©dagogique: <strong>OK</strong></li>
            </ul>
            <p><strong>üéØ Syst√®me ROME op√©rationnel pour le hackathon !</strong></p>
        `, 'success');
    </script>
</body>

</html>